# ğŸ”— Ğ†Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ñ–Ñ Ğ ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ñ—Ğ² Ğ· ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµÑ€Ğ°Ğ¼Ğ¸ Ñ‚Ğ° Ğ¡ĞµÑ€Ğ²Ñ–ÑĞ°Ğ¼Ğ¸

## ĞÑ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ğ° ÑÑ…ĞµĞ¼Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Microservice Controller                     â”‚
â”‚         (MessagePattern Ğ´Ğ»Ñ inter-service communication)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Service Layer                               â”‚
â”‚  (Ğ‘Ñ–Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ñ–ĞºĞ°, Ğ²Ğ°Ğ»Ñ–Ğ´Ğ°Ñ†Ñ–Ñ, Ñ‚Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ñ–Ñ Ğ´Ğ°Ğ½Ğ¸Ñ…)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Repository Layer                            â”‚
â”‚   (Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğ´Ğ¾ Ğ‘Ğ” Ñ‡ĞµÑ€ĞµĞ· Prisma, ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»Ñ–Ğ½Ğ½Ñ Ğ´Ğ°Ğ½Ğ¸Ğ¼Ğ¸)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Database (Prisma)                           â”‚
â”‚                   SQLite / PostgreSQL                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3-Ñ€Ñ–Ğ²Ğ½ĞµĞ²Ğ° Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

### 1ï¸âƒ£ Ğ Ñ–Ğ²ĞµĞ½ÑŒ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµÑ€Ğ° (Controller Layer)

**Ğ’Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ°Ğ»ÑŒĞ½Ñ–ÑÑ‚ÑŒ**: ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ğ½Ğ½Ñ Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ¾Ğ¼Ğ»ĞµĞ½ÑŒ Ğ²Ñ–Ğ´ Ğ¼Ñ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑÑ–Ğ² Ñ‚Ğ° Ğ´ĞµĞ»ĞµĞ³ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ´Ğ¾ ÑĞµÑ€Ğ²Ñ–ÑÑƒ

```typescript
@Controller('database-users')
export class DatabaseUsersController {
  constructor(private readonly databaseUsersService: DatabaseUsersService) {}

  @MessagePattern('get_user_by_id')
  async getUserByID(@Payload() data: { id: string }) {
    try {
      const user = await this.databaseUsersService.getUserByID(data.id);
      return { success: true, data: user };
    } catch (error) {
      return { success: false, message: error.message };
    }
  }
}
```

**ĞšĞ»ÑÑ‡Ğ¾Ğ²Ñ– Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ğ¸:**
- âœ… Ğ’Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒÑ” `@MessagePattern` Ğ´Ğ»Ñ Ğ¼Ñ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑĞ½Ğ¾Ñ— ĞºĞ¾Ğ¼ÑƒĞ½Ñ–ĞºĞ°Ñ†Ñ–Ñ—
- âœ… Ğ”ĞµĞ»ĞµĞ³ÑƒÑ” Ğ²ÑÑ Ğ»Ğ¾Ğ³Ñ–ĞºÑƒ Ğ´Ğ¾ ÑĞµÑ€Ğ²Ñ–ÑÑƒ
- âœ… ĞĞ±Ñ€Ğ¾Ğ±Ğ»ÑÑ” Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºĞ¸ Ñ‚Ğ° Ğ¿Ğ¾Ğ²ĞµÑ€Ñ‚Ğ°Ñ” ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¾Ğ²Ğ°Ğ½Ñƒ Ğ²Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´ÑŒ
- âœ… ĞĞµ Ğ¼Ñ–ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ±Ñ–Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ñ–ĞºĞ¸
- âœ… ĞœĞ°Ñ” `@Payload()` Ğ´Ğ»Ñ ÑĞ²Ğ½Ğ¾Ñ— Ñ–Ğ½Ğ¶ĞµĞºÑ†Ñ–Ñ— Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ–Ğ²

### 2ï¸âƒ£ Ğ Ñ–Ğ²ĞµĞ½ÑŒ ÑĞµÑ€Ğ²Ñ–ÑÑƒ (Service Layer)

**Ğ’Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ°Ğ»ÑŒĞ½Ñ–ÑÑ‚ÑŒ**: Ğ‘Ñ–Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ñ–ĞºĞ°, Ğ²Ğ°Ğ»Ñ–Ğ´Ğ°Ñ†Ñ–Ñ, ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ†Ñ–Ñ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ñ—Ğ²

```typescript
@Injectable()
export class DatabaseUsersService {
  constructor(private readonly userRepository: UserRepository) {}

  async getUserByID(id: string) {
    return this.userRepository.findById(id);
  }

  async loginUser(email: string, password: string) {
    const user = await this.userRepository.authenticate(email, password);
    
    if (!user) {
      return {
        success: false,
        message: 'Invalid credentials'
      };
    }

    return {
      success: true,
      message: 'Login successful',
      user: await this.userRepository.findByIdSafe(user.id)
    };
  }
}
```

**ĞšĞ»ÑÑ‡Ğ¾Ğ²Ñ– Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ğ¸:**
- âœ… Ğ†Ğ½Ğ¶ĞµĞºÑ‚ÑƒÑ” Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ğ¹ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€
- âœ… ĞœÑ–ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ±Ñ–Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ñ–ĞºÑƒ (Ğ²Ğ°Ğ»Ñ–Ğ´Ğ°Ñ†Ñ–Ñ, Ñ‚Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ñ–Ñ)
- âœ… ĞĞ±Ñ€Ğ¾Ğ±Ğ»ÑÑ” ÑĞ¿ĞµÑ†Ğ¸Ñ„Ñ–Ñ‡Ğ½Ñ– Ğ´Ğ»Ñ Ğ´Ğ¾Ğ¼ĞµĞ½Ñƒ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ñ–Ñ—
- âœ… ĞŸĞ¾Ğ²ĞµÑ€Ñ‚Ğ°Ñ” ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¾Ğ²Ğ°Ğ½Ñƒ Ğ²Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´ÑŒ Ğ· ÑÑ‚Ğ°Ñ‚ÑƒÑĞ¾Ğ¼ ÑƒÑĞ¿Ñ–Ñ…Ñƒ

### 3ï¸âƒ£ Ğ Ñ–Ğ²ĞµĞ½ÑŒ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ñ (Repository Layer)

**Ğ’Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ°Ğ»ÑŒĞ½Ñ–ÑÑ‚ÑŒ**: Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğ´Ğ¾ Ğ´Ğ°Ğ½Ğ¸Ñ…, Ğ²Ğ·Ğ°Ñ”Ğ¼Ğ¾Ğ´Ñ–Ñ Ğ· Ğ‘Ğ”

```typescript
@Injectable()
export class UserRepository extends BaseRepository<User> {
  constructor(private readonly prisma: PrismaService) {
    super();
  }

  protected getModel(): any {
    return this.prisma.user;
  }

  async findByEmail(email: string): Promise<User | null> {
    return this.findOne({ email });
  }

  async authenticate(email: string, password: string): Promise<User | null> {
    const user = await this.findOne({ email });
    if (!user) return null;
    
    const isPasswordValid = await bcrypt.compare(password, user.password);
    return isPasswordValid ? user : null;
  }
}
```

**ĞšĞ»ÑÑ‡Ğ¾Ğ²Ñ– Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ğ¸:**
- âœ… Ğ Ğ¾Ğ·ÑˆĞ¸Ñ€ÑÑ” `BaseRepository<T>`
- âœ… Ğ ĞµĞ°Ğ»Ñ–Ğ·ÑƒÑ” `protected getModel()`
- âœ… ĞœĞ°Ñ” ÑĞ¿ĞµÑ†Ğ¸Ñ„Ñ–Ñ‡Ğ½Ñ– Ğ´Ğ»Ñ ÑÑƒÑ‚Ğ½Ğ¾ÑÑ‚Ñ– Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¸
- âœ… Ğ’Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ°Ñ” Ğ»Ğ¸ÑˆĞµ Ğ·Ğ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ´Ğ¾ Ğ‘Ğ”
- âœ… ĞĞ±Ñ€Ğ¾Ğ±Ğ»ÑÑ” Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºĞ¸ Ñ‡ĞµÑ€ĞµĞ· `ErrorHandler`

## ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´Ğ¸ Ğ¿Ğ¾Ñ‚Ğ¾ĞºÑ–Ğ² Ğ´Ğ°Ğ½Ğ¸Ñ…

### ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´ 1: ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ğ½Ğ½Ñ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°

```
Ğ—Ğ°Ğ¿Ğ¸Ñ‚ Ğ²Ñ–Ğ´ Ñ–Ğ½ÑˆĞ¾Ğ³Ğ¾ Ğ¼Ñ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑÑƒ:
  MessagePattern('get_user_by_id') â†’ { id: 'user-123' }
                â†“
DatabaseUsersController.getUserByID()
  â†“ (Ğ´ĞµĞ»ĞµĞ³ÑƒÑ”)
DatabaseUsersService.getUserByID(id)
  â†“ (Ğ´ĞµĞ»ĞµĞ³ÑƒÑ”)
UserRepository.findById(id)
  â†“ (Prisma Ğ·Ğ°Ğ¿Ğ¸Ñ‚)
Prisma.user.findUnique({ where: { id } })
  â†“
Ğ‘Ğ” (SQLite/PostgreSQL)
  â†“
{ id: 'user-123', name: 'John', email: 'john@example.com', ... }
  â†“ (Ğ¿Ğ¾Ğ²ĞµÑ€Ñ‚Ğ°Ñ”Ñ‚ÑŒÑÑ Ñ‡ĞµÑ€ĞµĞ· ÑÑ‚ĞµĞºĞ¸)
{ success: true, data: { ... } }
```

### ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´ 2: Ğ¡Ñ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ½Ñ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°

```
Ğ—Ğ°Ğ¿Ğ¸Ñ‚ Ğ²Ñ–Ğ´ Ñ–Ğ½ÑˆĞ¾Ğ³Ğ¾ Ğ¼Ñ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑÑƒ:
  MessagePattern('add_new_user') â†’ { name, email, password }
                â†“
DatabaseUsersController.addNewUser()
  â†“ (Ğ´ĞµĞ»ĞµĞ³ÑƒÑ”)
DatabaseUsersService.addNewUser(data)
  â”œâ”€ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ñ–ÑĞ½ÑƒĞ²Ğ°Ğ½Ğ½Ñ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°
  â”‚   UserRepository.findByEmail(email)
  â”‚   â†“ Prisma.user.findFirst({ where: { email } })
  â”‚
  â””â”€ Ğ¯ĞºÑ‰Ğ¾ Ğ½Ğµ Ñ–ÑĞ½ÑƒÑ”:
      UserRepository.create(data)
        â”œâ”€ Ğ¥ĞµÑˆÑƒÑ” Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ (bcryptjs)
        â””â”€ Prisma.user.create({ data: { ...data, password: hashedPassword } })
          â†“
          Ğ‘Ğ”
          â†“
        { success: true, message: '...', user: { ... } }
```

### ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´ 3: ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ğ½Ğ½Ñ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ–Ğ² Ğ· Ğ¿Ğ°Ğ³Ñ–Ğ½Ğ°Ñ†Ñ–Ñ”Ñ

```
Ğ—Ğ°Ğ¿Ğ¸Ñ‚:
  MessagePattern('get_products_dynamically') â†’ { take: 20, page: 1 }
                â†“
DatabaseProductsController.getDynamicallyLoadedProducts()
  â†“
DatabaseProductsService.getPaginatedProducts(20, 1)
  â†“
ProductRepository.findPaginated(
  {},
  {
    pagination: { limit: 20, page: 1 },
    include: { attributes: true },
    orderBy: { createdAt: 'desc' }
  }
)
  â”œâ”€ Prisma.products.findMany(...)
  â””â”€ Prisma.products.count(...)
    â†“
    Ğ‘Ğ”
    â†“
  {
    data: [...],
    meta: { total: 150, page: 1, limit: 20, hasMore: true }
  }
```

## Ğ—Ğ°Ğ»ĞµĞ¶Ğ½Ğ¾ÑÑ‚Ñ– Ğ² Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ–

```typescript
@Module({
  // Ğ†Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ÑƒÑ”Ğ¼Ğ¾ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ñ—Ğ² Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ
  imports: [RepositoriesModule],
  
  controllers: [
    DatabaseUsersController,
    DatabaseProductsController,
    DatabaseOrdersController,
    DatabaseAnalyticsController
  ],
  
  providers: [
    DatabaseUsersService,
    DatabaseProductsService,
    DatabaseOrdersService,
    DatabaseAnalyticsService
  ]
})
export class DatabaseModule {}
```

## ĞœÑ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑĞ½Ğ° ĞºĞ¾Ğ¼ÑƒĞ½Ñ–ĞºĞ°Ñ†Ñ–Ñ

Ğ£ÑÑ– ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµÑ€Ğ¸ Ğ¼Ğ°ÑÑ‚ÑŒ Ğ²Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ½Ñ– `@MessagePattern`:

### Users:
- `get_all_users` - Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ Ğ²ÑÑ–Ñ… ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ñ–Ğ²
- `get_user_by_id` - Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ° Ğ¿Ğ¾ ID
- `get_user_by_email` - Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ° Ğ¿Ğ¾ email
- `add_new_user` - ÑÑ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğ¸ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°
- `login_user` - Ğ°Ğ²Ñ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ñ–ĞºĞ°Ñ†Ñ–Ñ
- `delete_user` - Ğ²Ğ¸Ğ´Ğ°Ğ»Ğ¸Ñ‚Ğ¸ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°
- `update_user` - Ğ¾Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°

### Products:
- `get_products` - ÑƒÑÑ– Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸
- `get_products_dynamically` - Ğ· Ğ¿Ğ°Ğ³Ñ–Ğ½Ğ°Ñ†Ñ–Ñ”Ñ
- `get_product_by_id` - Ğ¿Ğ¾ ID
- `get_product_by_name` - Ğ¿Ğ¾ Ğ½Ğ°Ğ·Ğ²Ñ–
- `add_product` - ÑÑ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚
- `edit_product` - Ğ¾Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚
- `delete_product_by_id` - Ğ²Ğ¸Ğ´Ğ°Ğ»Ğ¸Ñ‚Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚
- `save_product_image` - Ğ·Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶Ğ¸Ñ‚Ğ¸ Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ½Ñ
- `edit_image` - Ğ¾Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ½Ñ

### Orders:
- `get_order_by_id` - Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ Ğ·Ğ°Ğ¼Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ
- `add_order` - ÑÑ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğ¸ Ğ·Ğ°Ğ¼Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ
- `get_user_orders` - Ğ·Ğ°Ğ¼Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°
- `get_all_orders` - ÑƒÑÑ– Ğ·Ğ°Ğ¼Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ
- `update_order_status` - Ğ¾Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑ
- `get_orders_by_status` - Ñ„Ñ–Ğ»ÑŒÑ‚Ñ€ Ğ·Ğ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ¾Ğ¼
- `delete_order` - Ğ²Ğ¸Ğ´Ğ°Ğ»Ğ¸Ñ‚Ğ¸ Ğ·Ğ°Ğ¼Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ
- `get_order_statistics` - ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°

### Analytics:
- `get_product_analytics_by_id` - Ğ°Ğ½Ğ°Ğ»Ñ–Ñ‚Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñƒ
- `create-metrics-record` - ÑÑ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğ¸ Ğ·Ğ°Ğ¿Ğ¸Ñ
- `update-engagement-metrics` - Ğ¾Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ²Ğ·Ğ°Ñ”Ğ¼Ğ¾Ğ´Ñ–Ñ—
- `update-rating-metrics` - Ğ¾Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
- `increment-metric` - Ğ·Ğ±Ñ–Ğ»ÑŒÑˆĞ¸Ñ‚Ğ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºÑƒ
- `get-top-products` - Ñ‚Ğ¾Ğ¿ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸
- `get-analytics-with-product` - Ğ°Ğ½Ğ°Ğ»Ñ–Ñ‚Ğ¸ĞºĞ° Ğ· Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ¼

## ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ´Ğ»Ñ Ğ½Ğ¾Ğ²Ğ¸Ñ… Ñ„ÑƒĞ½ĞºÑ†Ñ–Ğ¹

### Ğ¯Ğº Ğ´Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ½Ğ¾Ğ²Ñƒ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ñ–Ñ:

1. **Ğ”Ğ¾Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ² Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ğ¹**:
```typescript
// UserRepository
async findByRole(role: string): Promise<User[]> {
  return this.find({ role });
}
```

2. **Ğ”Ğ¾Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ² ÑĞµÑ€Ğ²Ñ–Ñ**:
```typescript
// DatabaseUsersService
async getUsersByRole(role: string) {
  try {
    const users = await this.userRepository.findByRole(role);
    return { success: true, data: users };
  } catch (error) {
    return { success: false, message: error.message };
  }
}
```

3. **Ğ”Ğ¾Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ² ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµÑ€**:
```typescript
// DatabaseUsersController
@MessagePattern('get_users_by_role')
async getUsersByRole(@Payload() data: { role: string }) {
  return this.databaseUsersService.getUsersByRole(data.role);
}
```

## ĞĞ±Ñ€Ğ¾Ğ±ĞºĞ° Ğ¿Ğ¾Ğ¼Ğ¸Ğ»Ğ¾Ğº

Ğ’ÑÑ– Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºĞ¸ Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ»ÑÑÑ‚ÑŒÑÑ Ğ½Ğ° Ñ€Ñ–Ğ²Ğ½Ñ– Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ñ Ñ‡ĞµÑ€ĞµĞ· `ErrorHandler`:

```typescript
// Ğ’ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ñ—
try {
  return await this.prisma.user.create({ data });
} catch (error) {
  ErrorHandler.handleError(error, 'User');
}

// ErrorHandler ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚ÑƒÑ” Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºĞ¸ Prisma:
// P2002 â†’ EntityAlreadyExistsError (409)
// P2025 â†’ EntityNotFoundError (404)
// Ñ–Ğ½ÑˆÑ– â†’ DatabaseError (500)
```

ĞĞ° Ñ€Ñ–Ğ²Ğ½Ñ– ÑĞµÑ€Ğ²Ñ–ÑÑƒ Ğ²ÑÑ– Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºĞ¸ Ğ²Ğ»Ğ¾Ğ²Ğ»ÑÑÑ‚ÑŒÑÑ Ñ‚Ğ° Ğ¿Ğ¾Ğ²ĞµÑ€Ñ‚Ğ°ÑÑ‚ÑŒÑÑ Ğ² ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¾Ğ²Ğ°Ğ½Ğ¾Ğ¼Ñƒ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ–:

```typescript
{
  success: false,
  message: 'ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ½Ñ Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºĞ¸'
}
```

ĞĞ° Ñ€Ñ–Ğ²Ğ½Ñ– ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµÑ€Ğ° Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºĞ¸ Ñ‚ĞµĞ¶ Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ»ÑÑÑ‚ÑŒÑÑ Ñ‚Ğ° Ğ¿Ğ¾Ğ²ĞµÑ€Ñ‚Ğ°ÑÑ‚ÑŒÑÑ Ğ² Ğ¼Ñ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–Ñ:

```typescript
try {
  return { success: true, data: ... };
} catch (error) {
  return { success: false, message: error.message };
}
```

## Ğ¢Ğ¸Ğ¿Ñ–Ğ·Ğ°Ñ†Ñ–Ñ

Ğ£ÑĞµ Ñ‚Ğ¸Ğ¿Ñ–Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ñ‡ĞµÑ€ĞµĞ· TypeScript Ñ–Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ¸:

```typescript
// Ğ’ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–ÑÑ…
export interface ICreateUserInput extends ICreateInput<User> {
  name: string;
  email: string;
  password: string;
  role?: string;
}

// Ğ£ ÑĞµÑ€Ğ²Ñ–ÑĞ°Ñ…
async addNewUser(data: ICreateUserInput) {
  // TypeScript Ğ¿ĞµÑ€ĞµĞ²Ñ–Ñ€Ğ¸Ñ‚ÑŒ Ñ‚Ğ¸Ğ¿Ğ¸
}

// Ğ£ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµÑ€Ğ°Ñ…
async addNewUser(@Payload() data: any) {
  // ĞĞ° runtime Ğ¼Ğ°ÑĞ¸Ğ² Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ–Ğ², Ğ°Ğ»Ğµ Ñ‚Ğ¸Ğ¿Ğ¸ Ğ¿ĞµÑ€ĞµĞ²Ñ–Ñ€ÑÑÑ‚ÑŒÑÑ Ñƒ ÑĞµÑ€Ğ²Ñ–ÑÑ–
}
```

## Ğ¢ĞµÑÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ

Ğ›ĞµĞ³ĞºĞ¾ Ğ¿Ğ¸ÑĞ°Ñ‚Ğ¸ unit-Ñ‚ĞµÑÑ‚Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ»ĞµĞ¶Ğ½Ñ–ÑÑ‚ÑŒ Ñ–Ğ½Ğ¶ĞµĞºÑ†Ñ–Ñ—:

```typescript
describe('UserService', () => {
  let service: DatabaseUsersService;
  let mockRepository: jest.Mock;

  beforeEach(() => {
    mockRepository = {
      findById: jest.fn(),
      findByEmail: jest.fn(),
      create: jest.fn()
    };
    
    service = new DatabaseUsersService(mockRepository as any);
  });

  it('should return user', async () => {
    mockRepository.findById.mockResolvedValue({ id: '123', name: 'John' });
    
    const result = await service.getUserByID('123');
    
    expect(result).toEqual({ id: '123', name: 'John' });
  });
});
```

## ĞŸĞµÑ€ĞµĞ²Ğ°Ğ³Ğ¸ Ñ‚Ğ°ĞºĞ¾Ñ— Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ¸

âœ… **Ğ§Ğ¸ÑÑ‚Ğ¸Ğ¹ ĞºĞ¾Ğ´** - ĞºĞ¾Ğ¶ĞµĞ½ ÑˆĞ°Ñ€ Ğ¼Ğ°Ñ” Ğ¾Ğ´Ğ½Ñƒ Ğ²Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ°Ğ»ÑŒĞ½Ñ–ÑÑ‚ÑŒ  
âœ… **Ğ›ĞµĞ³ĞºĞ¾ Ñ‚ĞµÑÑ‚ÑƒĞ²Ğ°Ñ‚Ğ¸** - Ğ·Ğ°Ğ»ĞµĞ¶Ğ½Ğ¾ÑÑ‚Ñ– Ñ–Ğ½Ğ¶ĞµĞºÑ‚ÑƒÑÑ‚ÑŒÑÑ  
âœ… **Ğ›ĞµĞ³ĞºĞ¾ Ñ€Ğ¾Ğ·ÑˆĞ¸Ñ€ÑĞ²Ğ°Ñ‚Ğ¸** - Ğ´Ğ¾Ğ´Ğ°Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ½Ğ¾Ğ²Ñ– Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¸ Ğ±ĞµĞ· Ğ·Ğ¼Ñ–Ğ½ Ñ–Ğ½ÑˆĞ¸Ñ…  
âœ… **Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»Ñ–Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ¾Ğ±Ñ€Ğ¾Ğ±ĞºĞ° Ğ¿Ğ¾Ğ¼Ğ¸Ğ»Ğ¾Ğº** - `ErrorHandler`  
âœ… **ĞœÑ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑĞ½Ğ° ÑÑƒĞ¼Ñ–ÑĞ½Ñ–ÑÑ‚ÑŒ** - `MessagePattern` Ğ¿Ñ€Ğ°Ñ†ÑÑ” ĞºĞ¾Ñ€ĞµĞºÑ‚Ğ½Ğ¾  
âœ… **Ğ¢Ğ¸Ğ¿Ğ¾Ğ²Ğ° Ğ±ĞµĞ·Ğ¿ĞµĞºĞ°** - Ğ²ĞµÑÑŒ ĞºĞ¾Ğ´ Ñ‚Ğ¸Ğ¿Ñ–Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹  
âœ… **DRY Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿** - Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ¸Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ñ–Ğ¾Ğ½Ğ°Ğ» Ğ² `BaseRepository`  
âœ… **SOLID** - ÑƒÑÑ– 5 Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ–Ğ² Ğ´Ğ¾Ñ‚Ñ€Ğ¸Ğ¼ÑƒÑÑ‚ÑŒÑÑ
